package com;

import java.util.ArrayList;
import java.util.List;

public class OrderModel {
    public static class OrderItem {
        String name, option;
        int price, qty;
        public OrderItem(String n, int p, String o) {
            this.name = n; this.price = p; this.option = o; this.qty = 1;
        }
    }

    private List<OrderItem> basket = new ArrayList<>();
    private boolean isMember = false;

    public void addItem(String name, int price, String opt) {
        basket.add(new OrderItem(name, price, opt));
    }

    public void updateQty(int index, int delta) {
        if (index >= 0 && index < basket.size()) {
            basket.get(index).qty += delta;
            if (basket.get(index).qty <= 0) basket.remove(index);
        }
    }

    public void removeItem(int index) {
        if (index >= 0 && index < basket.size()) basket.remove(index);
    }

    public void clear() { basket.clear(); isMember = false; }
    public List<OrderItem> getBasket() { return basket; }
    public void setMember(boolean m) { this.isMember = m; }
    public boolean isMember() { return isMember; }

    public int getTotalAmount() {
        int sum = basket.stream().mapToInt(i -> i.price * i.qty).sum();
        return isMember ? (int)(sum * 0.9) : sum;
    }
    public int getTotalQty() {
        return basket.stream().mapToInt(i -> i.qty).sum();
    }
}

------------------------------------------------------------------------------------


package com;

import javax.swing.*;
import javax.swing.border.*;
import java.awt.*;

public class DrinkView extends JFrame {
    public JPanel menuPanel = new JPanel(), orderListPanel = new JPanel();
    public JLabel lblTime = new JLabel(), lblTotalInfo = new JLabel("數量總計：0 | 金額總計：$0 ");
    public JTextArea textArea = new JTextArea(10, 25);
    public JCheckBox chkMember = new JCheckBox("黑卡會員 9 折");
    public JButton btnSubmit = new JButton("送出結帳"), btnClear = new JButton("全單清除"), 
                   btnPrint = new JButton("列印"), btnExit = new JButton("關閉");

    public DrinkView() {
        setTitle("LOUISA POS");
        setSize(1200, 750);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout(15, 15));
        getContentPane().setBackground(new Color(240, 240, 240));

        JPanel top = new JPanel(new BorderLayout());
        top.setBackground(new Color(255, 120, 0));
        top.setPreferredSize(new Dimension(0, 60));
        lblTime.setForeground(Color.WHITE);
        lblTime.setFont(new Font("微軟正黑體", Font.BOLD, 15));
        top.add(new JLabel("  LOUISA PROFESSIONAL POS (MVC)", JLabel.LEFT), BorderLayout.WEST);
        top.add(lblTime, BorderLayout.EAST);
        add(top, BorderLayout.NORTH);

        menuPanel.setLayout(new BoxLayout(menuPanel, BoxLayout.Y_AXIS));
        JScrollPane menuScroll = new JScrollPane(menuPanel);
        menuScroll.setPreferredSize(new Dimension(650, 0));
        menuScroll.setBorder(new TitledBorder("商品選單"));
        add(menuScroll, BorderLayout.WEST);

        JPanel right = new JPanel(new BorderLayout(10, 10));
        orderListPanel.setLayout(new BoxLayout(orderListPanel, BoxLayout.Y_AXIS));
        right.add(new JScrollPane(orderListPanel), BorderLayout.CENTER);

        JPanel sumPanel = new JPanel(new BorderLayout());
        lblTotalInfo.setFont(new Font("微軟正黑體", Font.BOLD, 18));
        lblTotalInfo.setForeground(Color.RED);
        textArea.setFont(new Font("Monospaced", Font.PLAIN, 13));
        sumPanel.add(lblTotalInfo, BorderLayout.NORTH);
        sumPanel.add(new JScrollPane(textArea), BorderLayout.CENTER);
        right.add(sumPanel, BorderLayout.SOUTH);
        add(right, BorderLayout.CENTER);

        JPanel bot = new JPanel(new FlowLayout(FlowLayout.RIGHT, 15, 10));
        bot.add(chkMember); bot.add(btnSubmit); bot.add(btnClear); bot.add(btnPrint); bot.add(btnExit);
        add(bot, BorderLayout.SOUTH);
    }

    public void setTotalText(int qty, int amount) {
        lblTotalInfo.setText("數量總計：" + qty + " | 金額總計：$" + amount + " ");
    }
}



------------------------------------------------------------------------------------


package com;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.awt.print.PrinterException;

public class DrinkController {
    private OrderModel model;
    private DrinkView view;

    public DrinkController(OrderModel m, DrinkView v) {
        this.model = m; this.view = v;
        initMenu();
        initListeners();
    }

    private void initMenu() {
        addCategory("經典咖啡系列");
        addItem("莊園美式", 55, true);
        addItem("澳洲白咖啡", 65, true);
        addItem("莊園拿鐵", 75, true);
        addCategory("在地茶飲系列");
        addItem("錫蘭紅茶", 35, true);
        addItem("小農鮮奶茶", 55, true);
        addCategory("甜點輕食系列");
        addItem("法式千層", 85, false);
        addItem("火腿磚壓", 65, false);
    }

    private void addCategory(String name) {
        JLabel l = new JLabel("  " + name);
        l.setOpaque(true); l.setBackground(new Color(255, 230, 200));
        l.setFont(new Font("微軟正黑體", Font.BOLD, 16));
        l.setMaximumSize(new Dimension(1200, 40));
        view.menuPanel.add(l);
    }

    private void addItem(String name, int price, boolean isDrink) {
        JPanel row = new JPanel(new FlowLayout(FlowLayout.LEFT, 15, 5));
        row.setBackground(Color.WHITE);
        row.setMaximumSize(new Dimension(1200, 50));
        JLabel nl = new JLabel(name); nl.setPreferredSize(new Dimension(130, 30));
        JComboBox<String> ice = new JComboBox<>(new String[]{"--", "去冰", "少冰", "正常", "熱"});
        JComboBox<String> sug = new JComboBox<>(new String[]{"--", "無糖", "微糖", "半糖", "正常"});
        JButton btnAdd = new JButton("加入");

        btnAdd.addActionListener(e -> {
            if (isDrink && (ice.getSelectedIndex() == 0 || sug.getSelectedIndex() == 0)) {
                JOptionPane.showMessageDialog(view, "請選擇客製化內容！"); return;
            }
            model.addItem(name, price, isDrink ? "("+ice.getSelectedItem()+"/"+sug.getSelectedItem()+")" : "");
            refreshOrderList();
        });
        row.add(nl); row.add(new JLabel("$"+price));
        if(isDrink) { row.add(ice); row.add(sug); } else { row.add(new JLabel("                     (固定配方)                     ")); }
        row.add(btnAdd); view.menuPanel.add(row);
    }

    private void initListeners() {
        new Timer(1000, e -> view.lblTime.setText("目前時間：" + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()))).start();
        view.btnExit.addActionListener(e -> System.exit(0));
        view.btnClear.addActionListener(e -> { model.clear(); refreshOrderList(); view.chkMember.setSelected(false); view.textArea.setText(""); });
        view.btnPrint.addMouseListener(new MouseAdapter() {
            public void mouseClicked(MouseEvent e) { try { view.textArea.print(); } catch (PrinterException e1) { e1.printStackTrace(); } }
        });
        view.btnSubmit.addActionListener(e -> {
            if (model.getBasket().isEmpty()) return;
            view.textArea.setText("********** 結帳單 **********\n");
            for (OrderModel.OrderItem i : model.getBasket()) view.textArea.append(i.name + i.option + " x" + i.qty + " $" + (i.price*i.qty) + "\n");
            view.textArea.append("--------------------------\n總計：$" + model.getTotalAmount() + "\n****************************");
        });
        view.chkMember.addActionListener(e -> { model.setMember(view.chkMember.isSelected()); refreshOrderList(); });
    }

    private void refreshOrderList() {
        view.orderListPanel.removeAll();
        java.util.List<OrderModel.OrderItem> items = model.getBasket();
        for (int i = 0; i < items.size(); i++) {
            final int idx = i;
            OrderModel.OrderItem item = items.get(i);
            JPanel row = new JPanel(new BorderLayout());
            row.setMaximumSize(new Dimension(500, 35));
            row.setBorder(BorderFactory.createMatteBorder(0, 0, 1, 0, Color.LIGHT_GRAY));
            
            JLabel info = new JLabel(" " + item.name + item.option + " $" + item.price);
            JPanel ctrl = new JPanel(new FlowLayout(FlowLayout.RIGHT));
            JButton btnM = new JButton("-"), btnP = new JButton("+"), btnX = new JButton("X");
            btnX.setForeground(Color.RED);
            
            btnM.addActionListener(e -> { model.updateQty(idx, -1); refreshOrderList(); });
            btnP.addActionListener(e -> { model.updateQty(idx, 1); refreshOrderList(); });
            btnX.addActionListener(e -> { model.removeItem(idx); refreshOrderList(); });

            ctrl.add(btnM); ctrl.add(new JLabel(String.valueOf(item.qty))); ctrl.add(btnP); ctrl.add(btnX);
            row.add(info, BorderLayout.CENTER); row.add(ctrl, BorderLayout.EAST);
            view.orderListPanel.add(row);
        }
        view.setTotalText(model.getTotalQty(), model.getTotalAmount());
        view.orderListPanel.revalidate(); view.orderListPanel.repaint();
    }
}


------------------------------------------------------------------------------------


package com;

public class Main {
    public static void main(String[] args) {
        OrderModel model = new OrderModel();
        DrinkView view = new DrinkView();
        new DrinkController(model, view);
        view.setVisible(true);
    }
}