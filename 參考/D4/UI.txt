package main;

import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import java.awt.Color;
import javax.swing.JLabel;
import javax.swing.SwingConstants;
import java.awt.Font;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.JButton;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.print.PrinterException;
import java.nio.file.Paths;
import java.text.SimpleDateFormat;
import java.util.Date;

import javax.swing.Timer;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class ArtUI extends JFrame
{

	private static final long serialVersionUID = 1L;
	private JPanel contentPane;
	private JTextField textInputPath;
	private JTextField textRewidth;
	private JTextField textOutputChars;
	private JTextField textOutputPath;
	private JTextField textGrayLevel;

	/**
	 * Launch the application.
	 */
	public static void main(String[] args)
	{
		EventQueue.invokeLater(new Runnable()
		{
			public void run()
			{
				try
				{
					ArtUI frame = new ArtUI();
					frame.setVisible(true);
				} catch (Exception e)
				{
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the frame.
	 */
	public ArtUI()
	{
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(100, 100, 800, 500);
		contentPane = new JPanel();
		contentPane.setBackground(new Color(0, 128, 255));
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(null);

		JLabel labelTitle = new JLabel("ASCII Art");
		labelTitle.setForeground(new Color(0, 0, 255));
		labelTitle.setFont(new Font("微軟正黑體", Font.PLAIN, 25));
		labelTitle.setHorizontalAlignment(SwingConstants.CENTER);
		labelTitle.setBounds(273, 10, 200, 36);
		labelTitle.setBackground(new Color(255, 255, 255));
		contentPane.add(labelTitle);

		JLabel labelTimer = new JLabel("");
		labelTimer.setHorizontalAlignment(SwingConstants.CENTER);
		labelTimer.setForeground(Color.BLUE);
		labelTimer.setFont(new Font("微軟正黑體", Font.PLAIN, 25));
		labelTimer.setBackground(Color.WHITE);
		labelTimer.setBounds(177, 56, 400, 36);
		contentPane.add(labelTimer);

		JLabel labelInput = new JLabel("檔案路徑");
		labelInput.setFont(new Font("微軟正黑體", Font.BOLD, 20));
		labelInput.setHorizontalAlignment(SwingConstants.CENTER);
		labelInput.setForeground(new Color(255, 128, 0));
		labelInput.setBounds(10, 103, 102, 44);
		contentPane.add(labelInput);

		JLabel labelRewidth = new JLabel("重設寬度");
		labelRewidth.setHorizontalAlignment(SwingConstants.CENTER);
		labelRewidth.setForeground(new Color(255, 128, 0));
		labelRewidth.setFont(new Font("微軟正黑體", Font.BOLD, 20));
		labelRewidth.setBounds(10, 187, 102, 44);
		contentPane.add(labelRewidth);

		JLabel labelChar = new JLabel("輸出字元");
		labelChar.setHorizontalAlignment(SwingConstants.CENTER);
		labelChar.setForeground(new Color(255, 128, 0));
		labelChar.setFont(new Font("微軟正黑體", Font.BOLD, 20));
		labelChar.setBounds(10, 282, 102, 44);
		contentPane.add(labelChar);

		JLabel labelOutput = new JLabel("輸出路徑");
		labelOutput.setHorizontalAlignment(SwingConstants.CENTER);
		labelOutput.setForeground(new Color(255, 128, 0));
		labelOutput.setFont(new Font("微軟正黑體", Font.BOLD, 20));
		labelOutput.setBounds(10, 149, 102, 44);
		contentPane.add(labelOutput);

		JLabel labelGrayLevel = new JLabel("顏色分界");
		labelGrayLevel.setHorizontalAlignment(SwingConstants.CENTER);
		labelGrayLevel.setForeground(new Color(255, 128, 0));
		labelGrayLevel.setFont(new Font("微軟正黑體", Font.BOLD, 20));
		labelGrayLevel.setBounds(10, 241, 102, 44);
		contentPane.add(labelGrayLevel);

		textInputPath = new JTextField();
		textInputPath.setForeground(new Color(0, 0, 0));
		textInputPath.setBounds(122, 103, 200, 36);
		contentPane.add(textInputPath);
		textInputPath.setColumns(10);

		textRewidth = new JTextField();
		textRewidth.setForeground(Color.BLACK);
		textRewidth.setColumns(10);
		textRewidth.setBounds(122, 195, 200, 36);
		contentPane.add(textRewidth);

		textOutputChars = new JTextField();
		textOutputChars.setForeground(Color.BLACK);
		textOutputChars.setColumns(10);
		textOutputChars.setBounds(122, 282, 200, 36);
		contentPane.add(textOutputChars);

		textOutputPath = new JTextField();
		textOutputPath.setForeground(Color.BLACK);
		textOutputPath.setColumns(10);
		textOutputPath.setBounds(122, 149, 200, 36);
		contentPane.add(textOutputPath);

		textGrayLevel = new JTextField();
		textGrayLevel.setForeground(Color.BLACK);
		textGrayLevel.setColumns(10);
		textGrayLevel.setBounds(122, 238, 200, 36);
		contentPane.add(textGrayLevel);

		JTextArea textAreaConsole = new JTextArea();
		textAreaConsole.setBounds(393, 102, 305, 332);
		contentPane.add(textAreaConsole);
		
		Timer timer = new Timer(
			1000,
			new ActionListener()
			{
				@Override
				public void actionPerformed(ActionEvent e)
				{
					String time = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date());
					labelTimer.setText(time);
				}
			}
		);
		timer.start();
		
		

		JButton buttonClearAll = new JButton("清除");
		buttonClearAll.addMouseListener(new MouseAdapter()
		{
			@Override
			public void mouseClicked(MouseEvent e)
			{
				textAreaConsole.setText("");
			}
		});
		buttonClearAll.setBounds(150, 328, 141, 23);
		contentPane.add(buttonClearAll);

		JButton buttonOutput = new JButton("輸出");
		buttonOutput.addMouseListener(new MouseAdapter()
		{
			@Override
			public void mouseClicked(MouseEvent e)
			{
				for (var inputCategory : ArtDefiner.InputCategory.values())
				{
					try
					{
						switch (inputCategory)
						{
						case InputPath:
							Paths.get(textInputPath.getText());
							break;
						case OutputPath:
							textOutputPath.getText();
							break;
						case Rewidth:
							Integer.parseInt(textRewidth.getText());
							break;
						case GrayScaleLevel:
							Integer.parseInt(textGrayLevel.getText());
							break;
						case Character:
							textOutputChars.getText().charAt(0);
							break;

						}
					} catch (Exception error)
					{
						var message = "";
						message = error.toString();
						switch (inputCategory)
						{
						case InputPath:
							message = "請輸入有效輸入路徑";
							break;
						case OutputPath:
							message = "請輸入有效輸出路徑";
							break;
						case Rewidth:
							message = "請輸入有效的取樣寬度";
							break;
						case GrayScaleLevel:
							message = "請輸入有效的分界數值";
							break;
						case Character:
							message = "請輸入有效顯示字元";
							break;

						}

						textAreaConsole.setText(message);
						return;
					}
				}

				
				var model = new ArtModel(textInputPath.getText(), textOutputPath.getText(),
						Integer.parseInt(textRewidth.getText()), Integer.parseInt(textGrayLevel.getText()),
						textOutputChars.getText().charAt(0));

				textAreaConsole.setText(model.Output());
			}
		});
		buttonOutput.setBounds(150, 361, 141, 23);
		contentPane.add(buttonOutput);

		JButton buttonPrint = new JButton("列印");
		buttonPrint.addMouseListener(new MouseAdapter()
		{
			@Override
			public void mouseClicked(MouseEvent e)
			{
				try
				{
					textAreaConsole.print();
				}
				catch(PrinterException e1)
				{
					System.out.println(e1);
				}
			}
		});
		buttonPrint.setBounds(150, 394, 141, 23);
		contentPane.add(buttonPrint);
		
		JButton buttonQuit = new JButton("關閉");
		buttonQuit.addMouseListener(new MouseAdapter() {
			@Override
			public void mouseClicked(MouseEvent e) {
				System.exit(0);
			}
		});
		buttonQuit.setBounds(150, 427, 141, 23);
		contentPane.add(buttonQuit);
	}
}
